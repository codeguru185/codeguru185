import pandas as pd

# Load the CSV file into a pandas DataFrame
df = pd.read_csv('your_input_file.csv')  # Replace 'your_input_file.csv' with your CSV file path

# Create a set to store base patterns that should be removed
base_patterns_to_remove = set()

# Iterate through each row to check for base patterns
for index, row in df.iterrows():
    base_pattern = None
    for col in df.columns:
        value = row[col]
        if any(value.endswith('_' + str(suffix)) for suffix in range(10)):
            base_pattern = value.rsplit('_', 1)[0]
            if base_pattern in df.columns:
                base_patterns_to_remove.add(base_pattern)

# Remove columns corresponding to base patterns
filtered_df = df.drop(columns=list(base_patterns_to_remove))

# Save the filtered DataFrame to a new CSV file
filtered_df.to_csv('your_output_file.csv', index=False)  # Replace 'your_output_file.csv' with your desired output file path
