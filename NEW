SELECT 
    db.database_name,
    CASE 
        WHEN db.database_name LIKE '%_SHARE' THEN 'SHARED DATABASE'
        ELSE 'REGULAR DATABASE'
    END AS database_type,
    s.schema_name
FROM 
    snowflake.account_usage.databases db
JOIN 
    snowflake.account_usage.schemas s
    ON db.database_name = s.database_name
WHERE 
    s.deleted IS NULL
    AND db.deleted IS NULL
    AND s.schema_name != 'PUBLIC'  -- Exclude PUBLIC schema
ORDER BY 
    db.database_name, s.schema_name;
